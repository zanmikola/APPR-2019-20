---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Žan Mikola"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

V projektu bom analiziral izpust toplgrednih plinov v Sloveniji.
Poizkusil bom poiskati povezavo med gospodarsko rastjo in izpustom BDP, oziroma ugotoviti ali gospodarska rast pripomore k investicijam in davkom na okolje.
Na koncu projekta bom tudi predstavil, koliko se v posameznih regijah investira v zmanjšanje toplogrednih plinov.


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke sem uvozil iz spletne strani Statističnega urada Republike Slovenija. Podatke imam v dveh razpredelnicah v obliki *tidy data*.

1. 'zdruzena_tabla' - podatki o izpusti toplogrednih plinov, davkih, investicijah in BDP-ju v Sloveniji
-`leto` - spremenljivka: leto meritve(2010-2017)
  - `DEJAVNOST` - spremenljivka: gospodarske dejavnosti,
  - `Investicije mio €` - meritev: investicije v varovanje okolja
  - `Davki mio €` - meritev: okoljski davki 
  - `Proizvodnja mio €` - meritev: BDP države
  - `Izpusti (Mg)` - meritev: izpust plinov CH4, SF6, CO2, N20 v miligramih
  - `Izpusti CH4 (Mg)` - meritev: izpust plinov CH4 v miligramih
  - `Izpusti N20 (Mg)` - meritev: izpust plinov N20 v miligramih
  - `Izpusti CO2 (Mg)` - meritev: izpust plinov CO2 v miligramih
  - `Izpusti SF6 (Mg)` - meritev: izpust plinov SF6 v miligramih

2. 'regije' - podatki o investicijah za varovanje okolja, glede na namen
-`leto` - spremenljivka: leto meritve(2010-2017)
  - `STATISTIČNA.REGIJA` - spremenljivka: ime regije,
  - `INVESTICIJE` - spremenljivka: namen za kaj se je investiralo
  - `Investicije.za.varstvo.okolja` - meritev: tisoč € investirano

3. 'evropa' - podatki o izpustih toplogrednih plinov v Evropi
-`TIME` - spremenljivka: leto meritve(2010-2017)
  - `GEO` - spremenljivka: ime evropske države
  - `tisocton` - meritev: količina (v tisoš tonah) izpuščenih toplogrednih plinov
  
  
  
***

# Analiza in vizualizacija podatkov


```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
#uvoz grafov
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```


Spodnji graf prikazuje trend naraščanja oziroma padanja investicij in davkov, glede na trend naraščanja BDP-ja.
```{r grafi_osnovni, echo=FALSE, fig.align='center', warning=FALSE}
print(graf2)
```


Spodnji grafi prikazujejo izpuste toplogrednih plinov, glede na gospodarske panoge. 
```{r grafi_osnovni2, echo=FALSE, fig.align='center', warning=FALSE}
print(graf5.1)
print(graf5)
```

Spodnji graf prikazuje indekse naraščanja investiranega denarja za varovanje okolja na splošno in za ohranjanje čistega zraka.Črna črta prikazuje trend rasti BDP-ja. 
```{r grafi_inevsticije, echo=FALSE, fig.align='center', warning=FALSE}
print(graf6)
```
Spodnji graf prikazuje indeks naraščanja oziroma zmanjševanja izpustov posameznega toplogrednega plina, glede na referenčno leto 2010
```{r grafi_plini, echo=FALSE, fig.align='center', warning=FALSE}
print(graf7)
```

Spodnji graf prikazuje izpuste toplogrednih plinov v Evropi za posamezna leta. Točke prikazujejo izpuste posaemznih držav.
```{r grafi_evropa, echo=FALSE, fig.align='center', warning=FALSE}
print(graf8)
```

Spodnji zemljevid prikazuje, koliko okoljskih investicij je bilo namenjenih v posamezni regiji v Sloveniji
```{r zemljevid1, echo=FALSE, fig.align='center', fig.cap='Zemljevid okoljskih investicij'}
plot(zemljevid.investicije)

```
Spodnji zemljevid prikazuje, koliko  investicij za zmanjševanje onesaževanja zraka je bilo namenjenih v posamezni regiji v Sloveniji
```{r zemljevid2, echo=FALSE, fig.align='center', fig.cap='Zemljevid investicij za zmanjševanje onesaževanja zraka'}
plot(zemljevid.zrak)
```
Spodnji zemljevid prikazuje, koliko toplogrednih plinov so posamezne članice EU izpustile med leti 2010 - 2017
```{r zemljevid3, echo=FALSE, fig.align='center', fig.cap='Zemljevid izpustov toplogrednih plinov v Evropi'}
plot(eumap1)
```
***

 Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
#uvoz grafov
source("analiza/analiza.r", encoding="UTF-8")
```

Spodnja grafa prikazujeta, kako bi naj rastel BDP in izpusti v prihodnjih letih, glede na trende iz preteklosti.
```{r grafi_napredni, echo=FALSE, fig.align='center', warning=FALSE}
print(graf_regresija1)
print(graf_regresija2)

```




***

```{r shiny, echo=FALSE}
shinyAppDir("shiny", options=list(width="100%", height=600))
```
